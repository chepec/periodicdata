%\VignetteIndexEntry{Periodic Table of the Elements}
%\VignetteEngine{knitr::knitr}
%\VignetteKeyword{Periodic table}
%\VignetteKeyword{IUPAC}
%\VignetteKeyword{LaTeX}
%\VignetteKeyword{TikZ}

%% This work was created by Taha Ahmed, 2010
%% Last updated: 2019-07-30
%% This work is a derived work.
%% Original work by Ivan Griffin
%% http://www.texample.net/tikz/examples/periodic-table-of-chemical-elements/
%% Layout based on the IUPAC periodic table
%% https://iupac.org/what-we-do/periodic-table-of-elements/


\documentclass{article}\usepackage{knitr}
%%%% A4 page options
\usepackage[landscape,%
   a4paper,%
   noheadfoot,%
   hmargin={0.125cm,0cm},%
   vmargin={2cm,0cm}]%
   {geometry}
\pagestyle{empty}
%%%%

\usepackage{tikz}
\usepackage[tightpage]{preview}
\usetikzlibrary{shapes,calc,backgrounds}

\newcommand{\CommonElementTextFormat}[4]{%
   \begin{minipage}{2.2cm}
      \centering
      {\textbf{#1} \hfill #2}%
      \linebreak \linebreak
      {\textbf{#3}}%
      \linebreak \linebreak
      {{#4}}
   \end{minipage}
}

\newcommand{\NaturalElementTextFormat}[4]{%
  \CommonElementTextFormat{#1}{#2}{\LARGE {#3}}{#4}
}

\newcommand{\OutlineText}[1]{%
   % Couldn't find a nicer way of doing an outline font with TikZ
   % other than using pdfliteral 1 Tr
   \pdfliteral direct {0.5 w 1 Tr}{#1}%
   \pdfliteral direct {1 w 0 Tr}%
}

\newcommand{\SyntheticElementTextFormat}[4]{%
   \CommonElementTextFormat{#1}{#2}{\OutlineText{\LARGE #3}}{#4}
}

\newlength{\LegendBoxHalfWidth}
\setlength{\LegendBoxHalfWidth}{0.4em}
\newlength{\LegendBoxYOffset}
\setlength{\LegendBoxYOffset}{1.25ex}
\newlength{\LegendTitleXOffset}
\setlength{\LegendTitleXOffset}{-1.0em}

% ----------------------------------------------------------------------
% R SETUP
% ----------------------------------------------------------------------

% ----------------------------------------------------------------------

% ----------------------------------------------------------------------
% R LOAD PACKAGES
% ----------------------------------------------------------------------

% ----------------------------------------------------------------------
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\begin{document}
\begin{preview}
%% Scale factor 0.56 fits snugly into a landscape A4 paper
\begin{tikzpicture}[font=\sffamily, scale=0.56, transform shape]

%% Fill Color Styles
   \tikzstyle{ElementFill} = [fill=yellow!15]
   \tikzstyle{AlkaliMetalFill} = [fill=blue!55]
   \tikzstyle{AlkalineEarthMetalFill} = [fill=blue!40]
   \tikzstyle{MetalFill} = [fill=blue!25]
   \tikzstyle{MetalloidFill} = [fill=orange!25]
   \tikzstyle{NonmetalFill} = [fill=green!25]
   \tikzstyle{HalogenFill} = [fill=green!40]
   \tikzstyle{NobleGasFill} = [fill=green!55]
   \tikzstyle{LanthanideActinideFill} = [fill=purple!25]

%% Element Styles
   \tikzstyle{Element} = [draw=black, ElementFill,
      minimum width=2.75cm, minimum height=2.75cm, node distance=2.75cm]
   \tikzstyle{Alkali Metal} = [Element, AlkaliMetalFill]
   \tikzstyle{Alkaline Earth Metal} = [Element, AlkalineEarthMetalFill]
   \tikzstyle{Transition Metal} = [Element, MetalFill]
   \tikzstyle{Metal} = [Element, MetalFill]
   \tikzstyle{Poor Metal} = [Element, MetalFill]
   \tikzstyle{Metalloid} = [Element, MetalloidFill]
   \tikzstyle{Nonmetal} = [Element, NonmetalFill]
   \tikzstyle{Chalcogen} = [Element, MetalloidFill]
   \tikzstyle{Halogen} = [Element, HalogenFill]
   \tikzstyle{NobleGas} = [Element, NobleGasFill]
   \tikzstyle{Noble Gas} = [Element, NobleGasFill]
   \tikzstyle{LanthanideActinide} = [Element, LanthanideActinideFill]
   \tikzstyle{Lanthanide} = [Element, LanthanideActinideFill]
   \tikzstyle{Actinide} = [Element, LanthanideActinideFill]
   \tikzstyle{PeriodLabel} = [font={\sffamily\LARGE}, node distance=2.0cm]
   \tikzstyle{GroupLabel} = [font={\sffamily\LARGE}, minimum width=2.75cm, node distance=2.0cm]
   \tikzstyle{TitleLabel} = [font={\sffamily\Huge\bfseries}]

%% Group 1 - IA
\node[name=H, Nonmetal] {\NaturalElementTextFormat{1}{1.00794}{H}{Hydrogen}};
 \node[name=Li, below of=H, Alkali Metal] {\NaturalElementTextFormat{3}{6.941}{Li}{Lithium}};
 \node[name=Na, below of=Li, Alkali Metal] {\NaturalElementTextFormat{11}{22.98977}{Na}{Sodium}};
 \node[name=K, below of=Na, Alkali Metal] {\NaturalElementTextFormat{19}{39.0983}{K}{Potassium}};
 \node[name=Rb, below of=K, Alkali Metal] {\NaturalElementTextFormat{37}{85.4678}{Rb}{Rubidium}};
 \node[name=Cs, below of=Rb, Alkali Metal] {\NaturalElementTextFormat{55}{132.90545}{Cs}{Cesium}};
 \node[name=Fr, below of=Cs, Alkali Metal] {\SyntheticElementTextFormat{87}{223}{Fr}{Francium}};



%% Group 2 - IIA
\node[name=Be, right of=Li, Alkaline Earth Metal] {\NaturalElementTextFormat{4}{9.012182}{Be}{Beryllium}};
 \node[name=Mg, below of=Be, Alkaline Earth Metal] {\NaturalElementTextFormat{12}{24.305}{Mg}{Magnesium}};
 \node[name=Ca, below of=Mg, Alkaline Earth Metal] {\NaturalElementTextFormat{20}{40.078}{Ca}{Calcium}};
 \node[name=Sr, below of=Ca, Alkaline Earth Metal] {\NaturalElementTextFormat{38}{87.62}{Sr}{Strontium}};
 \node[name=Ba, below of=Sr, Alkaline Earth Metal] {\NaturalElementTextFormat{56}{137.327}{Ba}{Barium}};
 \node[name=Ra, below of=Ba, Alkaline Earth Metal] {\SyntheticElementTextFormat{88}{226}{Ra}{Radium}};



%% Group 3 - IIIB
\node[name=Scandium, right of=Ca, Transition Metal] {\NaturalElementTextFormat{21}{44.95591}{Sc}{Scandium}};
 \node[name=Yttrium, below of=Scandium, Transition Metal] {\NaturalElementTextFormat{39}{88.90585}{Y}{Yttrium}};
 \node[name=lanthanoids, below of=Yttrium, Lanthanide] {\NaturalElementTextFormat{57-71}{}{}{lanthanoids}};
 \node[name=actinoids, below of=lanthanoids, Actinide] {\NaturalElementTextFormat{89-103}{}{}{actinoids}};



%% Group 4 - IVB
\node[name=Ti, right of=Scandium, Transition Metal] {\NaturalElementTextFormat{22}{47.867}{Ti}{Titanium}};
 \node[name=Zr, below of=Ti, Transition Metal] {\NaturalElementTextFormat{40}{91.224}{Zr}{Zirconium}};
 \node[name=Hf, below of=Zr, Transition Metal] {\NaturalElementTextFormat{72}{178.49}{Hf}{Hafnium}};
 \node[name=Rf, below of=Hf, Transition Metal] {\SyntheticElementTextFormat{104}{261}{Rf}{Rutherfordium}};



%% Group 5 - VB
\node[name=V, right of=Ti, Transition Metal] {\NaturalElementTextFormat{23}{50.9415}{V}{Vanadium}};
 \node[name=Nb, below of=V, Transition Metal] {\NaturalElementTextFormat{41}{92.90638}{Nb}{Niobium}};
 \node[name=Ta, below of=Nb, Transition Metal] {\NaturalElementTextFormat{73}{180.9479}{Ta}{Tantalum}};
 \node[name=Db, below of=Ta, Transition Metal] {\SyntheticElementTextFormat{105}{262}{Db}{Dubnium}};



%% Group 6 - VIB
\node[name=Cr, right of=V, Transition Metal] {\NaturalElementTextFormat{24}{51.9961}{Cr}{Chromium}};
 \node[name=Mo, below of=Cr, Transition Metal] {\NaturalElementTextFormat{42}{95.94}{Mo}{Molybdenum}};
 \node[name=W, below of=Mo, Transition Metal] {\NaturalElementTextFormat{74}{183.84}{W}{Tungsten}};
 \node[name=Sg, below of=W, Transition Metal] {\SyntheticElementTextFormat{106}{266}{Sg}{Seaborgium}};



%% Group 7 - VIIB
\node[name=Mn, right of=Cr, Transition Metal] {\NaturalElementTextFormat{25}{54.938049}{Mn}{Manganese}};
 \node[name=Tc, below of=Mn, Transition Metal] {\SyntheticElementTextFormat{43}{98}{Tc}{Technetium}};
 \node[name=Re, below of=Tc, Transition Metal] {\NaturalElementTextFormat{75}{186.207}{Re}{Rhenium}};
 \node[name=Bh, below of=Re, Transition Metal] {\SyntheticElementTextFormat{107}{264}{Bh}{Bohrium}};



%% Group 8 - VIIIB
\node[name=Fe, right of=Mn, Transition Metal] {\NaturalElementTextFormat{26}{55.845}{Fe}{Iron}};
 \node[name=Ru, below of=Fe, Transition Metal] {\NaturalElementTextFormat{44}{101.07}{Ru}{Ruthenium}};
 \node[name=Os, below of=Ru, Transition Metal] {\NaturalElementTextFormat{76}{190.23}{Os}{Osmium}};
 \node[name=Hs, below of=Os, Transition Metal] {\SyntheticElementTextFormat{108}{277}{Hs}{Hassium}};



%% Group 9 - VIIIB
\node[name=Co, right of=Fe, Transition Metal] {\NaturalElementTextFormat{27}{58.9332}{Co}{Cobalt}};
 \node[name=Rh, below of=Co, Transition Metal] {\NaturalElementTextFormat{45}{102.9055}{Rh}{Rhodium}};
 \node[name=Ir, below of=Rh, Transition Metal] {\NaturalElementTextFormat{77}{192.217}{Ir}{Iridium}};
 \node[name=Mt, below of=Ir, Transition Metal] {\SyntheticElementTextFormat{109}{268}{Mt}{Meitnerium}};



%% Group 10 - VIIIB
\node[name=Ni, right of=Co, Transition Metal] {\NaturalElementTextFormat{28}{58.6934}{Ni}{Nickel}};
 \node[name=Pd, below of=Ni, Transition Metal] {\NaturalElementTextFormat{46}{106.42}{Pd}{Palladium}};
 \node[name=Pt, below of=Pd, Transition Metal] {\NaturalElementTextFormat{78}{195.078}{Pt}{Platinum}};
 \node[name=Ds, below of=Pt, Transition Metal] {\SyntheticElementTextFormat{110}{281}{Ds}{Darmstadtium}};



%% Group 11 - IB
\node[name=Cu, right of=Ni, Transition Metal] {\NaturalElementTextFormat{29}{63.546}{Cu}{Copper}};
 \node[name=Ag, below of=Cu, Transition Metal] {\NaturalElementTextFormat{47}{107.8682}{Ag}{Silver}};
 \node[name=Au, below of=Ag, Transition Metal] {\NaturalElementTextFormat{79}{196.96655}{Au}{Gold}};
 \node[name=Rg, below of=Au, Transition Metal] {\SyntheticElementTextFormat{111}{272}{Rg}{Roentgenium}};



%% Group 12 - IIB
\node[name=Zn, right of=Cu, Transition Metal] {\NaturalElementTextFormat{30}{65.409}{Zn}{Zinc}};
 \node[name=Cd, below of=Zn, Transition Metal] {\NaturalElementTextFormat{48}{112.411}{Cd}{Cadmium}};
 \node[name=Hg, below of=Cd, Transition Metal] {\NaturalElementTextFormat{80}{200.59}{Hg}{Mercury}};
 \node[name=Cn, below of=Hg, Transition Metal] {\SyntheticElementTextFormat{112}{NA}{Cn}{Copernicium}};



%% Group 13 - IIIA
\node[name=Ga, right of=Zn, Poor Metal] {\NaturalElementTextFormat{31}{69.723}{Ga}{Gallium}};
 \node[name=Al, above of=Ga, Poor Metal] {\NaturalElementTextFormat{13}{26.981538}{Al}{Aluminum}};
 \node[name=B, above of=Al, Metalloid] {\NaturalElementTextFormat{5}{10.811}{B}{Boron}};
 \node[name=In, below of=Ga, Poor Metal] {\NaturalElementTextFormat{49}{114.818}{In}{Indium}};
 \node[name=Tl, below of=In, Poor Metal] {\NaturalElementTextFormat{81}{204.3833}{Tl}{Thallium}};
 \node[name=Nh, below of=Tl, Poor Metal] {\SyntheticElementTextFormat{113}{NA}{Nh}{Nihonium}};



%% Group 14 - IVA
\node[name=C, right of=B, Nonmetal] {\NaturalElementTextFormat{6}{12.0107}{C}{Carbon}};
 \node[name=Si, below of=C, Metalloid] {\NaturalElementTextFormat{14}{28.0855}{Si}{Silicon}};
 \node[name=Ge, below of=Si, Metalloid] {\NaturalElementTextFormat{32}{72.64}{Ge}{Germanium}};
 \node[name=Sn, below of=Ge, Poor Metal] {\NaturalElementTextFormat{50}{118.71}{Sn}{Tin}};
 \node[name=Pb, below of=Sn, Poor Metal] {\NaturalElementTextFormat{82}{207.2}{Pb}{Lead}};
 \node[name=Fl, below of=Pb, Poor Metal] {\SyntheticElementTextFormat{114}{NA}{Fl}{Flerovium}};



%% Group 15 - VA
\node[name=N, right of=C, Nonmetal] {\NaturalElementTextFormat{7}{14.0067}{N}{Nitrogen}};
 \node[name=P, below of=N, Nonmetal] {\NaturalElementTextFormat{15}{30.973761}{P}{Phosphorus}};
 \node[name=As, below of=P, Metalloid] {\NaturalElementTextFormat{33}{74.9216}{As}{Arsenic}};
 \node[name=Sb, below of=As, Metalloid] {\NaturalElementTextFormat{51}{121.76}{Sb}{Antimony}};
 \node[name=Bi, below of=Sb, Poor Metal] {\SyntheticElementTextFormat{83}{208.98038}{Bi}{Bismuth}};
 \node[name=Mc, below of=Bi, Poor Metal] {\SyntheticElementTextFormat{115}{NA}{Mc}{Moscovium}};



%% Group 16 - VIA
\node[name=O, right of=N, Chalcogen] {\NaturalElementTextFormat{8}{15.9994}{O}{Oxygen}};
 \node[name=S, below of=O, Chalcogen] {\NaturalElementTextFormat{16}{32.065}{S}{Sulfur}};
 \node[name=Se, below of=S, Chalcogen] {\NaturalElementTextFormat{34}{78.96}{Se}{Selenium}};
 \node[name=Te, below of=Se, Chalcogen] {\NaturalElementTextFormat{52}{127.6}{Te}{Tellurium}};
 \node[name=Po, below of=Te, Chalcogen] {\SyntheticElementTextFormat{84}{209}{Po}{Polonium}};
 \node[name=Lv, below of=Po, Poor Metal] {\SyntheticElementTextFormat{116}{NA}{Lv}{Livermorium}};



%% Group 17 - VIIA
\node[name=F, right of=O, Halogen] {\NaturalElementTextFormat{9}{18.9984032}{F}{Fluorine}};
 \node[name=Cl, below of=F, Halogen] {\NaturalElementTextFormat{17}{35.453}{Cl}{Chlorine}};
 \node[name=Br, below of=Cl, Halogen] {\NaturalElementTextFormat{35}{79.904}{Br}{Bromine}};
 \node[name=I, below of=Br, Halogen] {\NaturalElementTextFormat{53}{126.90447}{I}{Iodine}};
 \node[name=At, below of=I, Halogen] {\SyntheticElementTextFormat{85}{210}{At}{Astatine}};
 \node[name=Ts, below of=At, Halogen] {\SyntheticElementTextFormat{117}{NA}{Ts}{Tennessine}};



%% Group 18 - VIIIA
\node[name=Ne, right of=F, Noble Gas] {\NaturalElementTextFormat{10}{20.1797}{Ne}{Neon}};
 \node[name=He, above of=Ne, Noble Gas] {\NaturalElementTextFormat{2}{4.002602}{He}{Helium}};
 \node[name=Ar, below of=Ne, Noble Gas] {\NaturalElementTextFormat{18}{39.948}{Ar}{Argon}};
 \node[name=Kr, below of=Ar, Noble Gas] {\NaturalElementTextFormat{36}{83.798}{Kr}{Krypton}};
 \node[name=Xe, below of=Kr, Noble Gas] {\NaturalElementTextFormat{54}{131.293}{Xe}{Xenon}};
 \node[name=Rn, below of=Xe, Noble Gas] {\SyntheticElementTextFormat{86}{222}{Rn}{Radon}};
 \node[name=Og, below of=Rn, Noble Gas] {\SyntheticElementTextFormat{118}{NA}{Og}{Oganesson}};



%% Period labels
\node[name=Period1, left of=H, PeriodLabel] {1};
\node[name=Period2, left of=Li, PeriodLabel] {2};
\node[name=Period3, left of=Na, PeriodLabel] {3};
\node[name=Period4, left of=K, PeriodLabel] {4};
\node[name=Period5, left of=Rb, PeriodLabel] {5};
\node[name=Period6, left of=Cs, PeriodLabel] {6};
\node[name=Period7, left of=Fr, PeriodLabel] {7};



% this chunk would be harder to print using R, I think. Let it be for now.
%% Group
   \node[name=Group1, above of=H, GroupLabel]        {1 \hfill IA};
   \node[name=Group2, above of=Be, GroupLabel]       {2 \hfill IIA};
   \node[name=Group3, above of=Scandium, GroupLabel] {3 \hfill IIIA};
   \node[name=Group4, above of=Ti, GroupLabel]       {4 \hfill IVB};
   \node[name=Group5, above of=V, GroupLabel]        {5 \hfill VB};
   \node[name=Group6, above of=Cr, GroupLabel]       {6 \hfill VIB};
   \node[name=Group7, above of=Mn, GroupLabel]       {7 \hfill VIIB};
   \node[name=Group8, above of=Fe, GroupLabel]       {8 \hfill VIIIB};
   \node[name=Group9, above of=Co, GroupLabel]       {9 \hfill VIIIB};
   \node[name=Group10, above of=Ni, GroupLabel]      {10 \hfill VIIIB};
   \node[name=Group11, above of=Cu, GroupLabel]      {11 \hfill IB};
   \node[name=Group12, above of=Zn, GroupLabel]      {12 \hfill IIB};
   \node[name=Group13, above of=B, GroupLabel]       {13 \hfill IIIA};
   \node[name=Group14, above of=C, GroupLabel]       {14 \hfill IVA};
   \node[name=Group15, above of=N, GroupLabel]       {15 \hfill VA};
   \node[name=Group16, above of=O, GroupLabel]       {16 \hfill VIA};
   \node[name=Group17, above of=F, GroupLabel]       {17 \hfill VIIA};
   \node[name=Group18, above of=He, GroupLabel]      {18 \hfill VIIIA};


%% Lanthanoids
\node[name=La, below of=Rf, yshift=-1.4cm, Lanthanide] {\NaturalElementTextFormat{57}{138.9055}{La}{Lanthanum}};
 \node[name=Ce, right of=La, Lanthanide] {\NaturalElementTextFormat{58}{140.116}{Ce}{Cerium}};
 \node[name=Pr, right of=Ce, Lanthanide] {\NaturalElementTextFormat{59}{140.90765}{Pr}{Praseodymium}};
 \node[name=Nd, right of=Pr, Lanthanide] {\NaturalElementTextFormat{60}{144.24}{Nd}{Neodymium}};
 \node[name=Pm, right of=Nd, Lanthanide] {\SyntheticElementTextFormat{61}{145}{Pm}{Promethium}};
 \node[name=Sm, right of=Pm, Lanthanide] {\NaturalElementTextFormat{62}{150.36}{Sm}{Samarium}};
 \node[name=Eu, right of=Sm, Lanthanide] {\NaturalElementTextFormat{63}{151.964}{Eu}{Europium}};
 \node[name=Gd, right of=Eu, Lanthanide] {\NaturalElementTextFormat{64}{157.25}{Gd}{Gadolinium}};
 \node[name=Tb, right of=Gd, Lanthanide] {\NaturalElementTextFormat{65}{158.92534}{Tb}{Terbium}};
 \node[name=Dy, right of=Tb, Lanthanide] {\NaturalElementTextFormat{66}{162.5}{Dy}{Dysprosium}};
 \node[name=Ho, right of=Dy, Lanthanide] {\NaturalElementTextFormat{67}{164.93032}{Ho}{Holmium}};
 \node[name=Er, right of=Ho, Lanthanide] {\NaturalElementTextFormat{68}{167.259}{Er}{Erbium}};
 \node[name=Tm, right of=Er, Lanthanide] {\NaturalElementTextFormat{69}{168.93421}{Tm}{Thulium}};
 \node[name=Yb, right of=Tm, Lanthanide] {\NaturalElementTextFormat{70}{173.04}{Yb}{Ytterbium}};
 \node[name=Lu, right of=Yb, Lanthanide] {\NaturalElementTextFormat{71}{174.967}{Lu}{Lutetium}};



%% Actinoids
\node[name=Ac, below of=La, Actinide] {\SyntheticElementTextFormat{89}{227}{Ac}{Actinium}};
 \node[name=Th, right of=Ac, Actinide] {\SyntheticElementTextFormat{90}{232.0381}{Th}{Thorium}};
 \node[name=Pa, right of=Th, Actinide] {\SyntheticElementTextFormat{91}{231.03588}{Pa}{Protactinium}};
 \node[name=U, right of=Pa, Actinide] {\SyntheticElementTextFormat{92}{238.02891}{U}{Uranium}};
 \node[name=Np, right of=U, Actinide] {\SyntheticElementTextFormat{93}{237}{Np}{Neptunium}};
 \node[name=Pu, right of=Np, Actinide] {\SyntheticElementTextFormat{94}{244}{Pu}{Plutonium}};
 \node[name=Am, right of=Pu, Actinide] {\SyntheticElementTextFormat{95}{243}{Am}{Americium}};
 \node[name=Cm, right of=Am, Actinide] {\SyntheticElementTextFormat{96}{247}{Cm}{Curium}};
 \node[name=Bk, right of=Cm, Actinide] {\SyntheticElementTextFormat{97}{247}{Bk}{Berkelium}};
 \node[name=Cf, right of=Bk, Actinide] {\SyntheticElementTextFormat{98}{251}{Cf}{Californium}};
 \node[name=Es, right of=Cf, Actinide] {\SyntheticElementTextFormat{99}{252}{Es}{Einsteinium}};
 \node[name=Fm, right of=Es, Actinide] {\SyntheticElementTextFormat{100}{257}{Fm}{Fermium}};
 \node[name=Md, right of=Fm, Actinide] {\SyntheticElementTextFormat{101}{258}{Md}{Mendelevium}};
 \node[name=No, right of=Md, Actinide] {\SyntheticElementTextFormat{102}{259}{No}{Nobelium}};
 \node[name=Lr, right of=No, Actinide] {\SyntheticElementTextFormat{103}{262}{Lr}{Lawrencium}};



%% Draw dashed lines connecting Lanthanide breakout to main table
   \draw (actinoids.south west) edge[dashed] (La.north west)
      (actinoids.south east) edge[dashed] (La.north east);

%% Legend
   \node at ($(H.north -| Ti.west) + (0em,0em)$)
      [name=elementLegend, Element, fill=white]
      {\NaturalElementTextFormat{Z}{mass}{Symbol}{Name}};
   \node[Element, fill=white, below of=elementLegend, yshift=-1em]
      {\SyntheticElementTextFormat{}{}{man-made}{}};

   \node[name=AlkaliMetalLegend, anchor=north, black, AlkaliMetalFill,
      inner sep=\LegendBoxHalfWidth, rectangle, draw]
      at ($(elementLegend.north east) + (3em,0em)$) {};
   \node[right of=AlkaliMetalLegend, anchor=west, xshift=\LegendTitleXOffset]
      {Alkali metal};

   \node[name=AlkalineEarthMetalLegend, below of=AlkaliMetalLegend, yshift=1ex,
      black, AlkalineEarthMetalFill, inner sep=\LegendBoxHalfWidth, rectangle, draw] {};
   \node[right of=AlkalineEarthMetalLegend, anchor=west, xshift=\LegendTitleXOffset]
      {Alkaline earth metal};
   \node[name=MetalLegend, below of=AlkalineEarthMetalLegend, yshift=\LegendBoxYOffset,
      black, MetalFill, inner sep=\LegendBoxHalfWidth, rectangle, draw] {};
   \node[right of=MetalLegend, anchor=west, xshift=\LegendTitleXOffset] {Metal};
   \node[name=MetalloidLegend, below of=MetalLegend, yshift=\LegendBoxYOffset,
      black, MetalloidFill, inner sep=\LegendBoxHalfWidth, rectangle, draw] {};
   \node[right of=MetalloidLegend, anchor=west, xshift=\LegendTitleXOffset] {Metalloid};
   \node[name=NonmetalLegend, below of=MetalloidLegend, yshift=\LegendBoxYOffset,
      black, NonmetalFill, inner sep=\LegendBoxHalfWidth, rectangle, draw] {};
   \node[right of=NonmetalLegend, anchor=west, xshift=\LegendTitleXOffset] {Non-metal};
   \node[name=HalogenLegend, below of=NonmetalLegend, yshift=\LegendBoxYOffset,
      black, HalogenFill, inner sep=\LegendBoxHalfWidth, rectangle, draw] {};
   \node[right of=HalogenLegend, anchor=west, xshift=\LegendTitleXOffset] {Halogen};
   \node[name=NobleGasLegend, below of=HalogenLegend, yshift=\LegendBoxYOffset,
      black, NobleGasFill, inner sep=\LegendBoxHalfWidth, rectangle, draw] {};
   \node[right of=NobleGasLegend, anchor=west, xshift=\LegendTitleXOffset] {Noble gas};
   \node[name=LanthanideActinideLegend, below of=NobleGasLegend, yshift=\LegendBoxYOffset,
      black, LanthanideActinideFill, inner sep=\LegendBoxHalfWidth, rectangle, draw] {};
   \node[right of=LanthanideActinideLegend, anchor=west, xshift=\LegendTitleXOffset]
      {Lanthanoids/Actinoids};

%% Diagram Title
   \node at (Co.north east) [name=diagramTitle, TitleLabel, yshift=30em]
   {Periodic Table of the Elements};

   \begin{pgfonlayer}{background}
   \path[fill=white] (current bounding box.south west)
   rectangle (current bounding box.north east);
   \end{pgfonlayer}

\end{tikzpicture}
\end{preview}
\end{document}
